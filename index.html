<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ch√° do Jo√£o Victor ‚Äì V7</title>
  <link href="https://fonts.googleapis.com/css2?family=Chewy&display=swap" rel="stylesheet">
  <style>
    body{margin:0;padding:0;font-family:Arial,sans-serif;background:#b3d0b3;color:#5F805F}
    header{background:#fff;text-align:center;padding:10px}
    .lateral-esquerda,.lateral-direita{position:fixed;top:0;width:150px;height:100%;background:url('floresta_lateral.jpg') center/cover no-repeat;z-index:-1}
    .lateral-esquerda{left:0}.lateral-direita{right:0}
    .animal-strip{font-size:48px;display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
    .container{max-width:900px;margin:auto;padding:20px;text-align:center}
    .galeria{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;justify-content:center}
    .item{width:220px;height:320px;border:1px solid #5F805F;border-radius:10px;padding:10px;box-sizing:border-box;display:flex;flex-direction:column;justify-content:space-between;background:#fff}
    .item .emoji{font-size:48px}
    button{background:#5F805F;color:#fff;border:none;padding:10px;border-radius:5px;cursor:pointer;margin:5px}
    @media (max-width: 768px) {
      .galeria { grid-template-columns: repeat(2, 1fr); }
      .item { width: 100%; height: auto; }
      .modal-content { width: 95% !important; }
      .animal-strip { font-size: 32px !important; flex-wrap: wrap; }
      #titulo { font-size: 1.8em !important; }
    }
  </style>
</head>
<body>
  <div class="lateral-esquerda"></div>
  <div class="lateral-direita"></div>
  <header>
    <div class="animal-strip">üêµü¶äü¶âü¶íü¶ù ü¶Å üêØüêòüê∏üê¢ü¶ú</div>
    <h1 id="titulo" style="text-transform:uppercase; font-family:'Chewy', cursive; font-size:2.5em;">CH√Å DO JO√ÉO VICTOR</h1>
  </header>
  <div class="container">
    <h2 style="margin-top:20px; text-transform:uppercase;">Lista de Presentes</h2>
    <p>Se preferir contribuir com o nosso ch√°, escolha um presente para o Jo√£o!</p>
    <div id="presentes" class="galeria"></div>
  </div>
<script>
const nomesProdutos = [
  "Cuequinha Antiestresse",
  "Mamadeira Turbo 3000",
  "Fralda com Bluetooth",
  "Roup√£o Jedi Baby",
  "Patinho GPS de Banho",
  "Body Estampado de Dinossauro",
  "Babador Wi-Fi",
  "Naninha Falante",
  "Term√¥metro Musical",
  "Tapete de Dan√ßa Baby",
  "Kit Higiene com Glitter",
  "Travesseiro Antigravidade",
  "Copo Anti-Vazamento Jedi",
  "Almofada com Mem√≥ria Afetiva",
  "Livro M√°gico de Banho",
  "Canguru com Suspens√≥rio Ninja",
  "Cadeirinha com Ejetor de Risadas",
  "Organizador Intergal√°ctico",
  "Fralda Recarreg√°vel",
  "Ber√ßo com Porta USB",
  "Cortador de Unha com Lanterna",
  "Mochila com Porta Fralda Emergencial",
  "Term√¥metro Inteligente",
  "Tapete com Alarme de Soneca",
  "Trocador com Wi-Fi",
  "Cobertor Antiestresse",
  "Touca com Isolamento T√©rmico",
  "Meias de Super-Her√≥i",
  "Toalha que Abra√ßa",
  "Travesseiro Son√≠fero",
  "Kit Talheres Gamer",
  "Len√ßol Autolimpante",
  "Pote T√©rmico com Bluetooth",
  "Mordedor de Arco-√çris",
  "Sabonete com Aroma de Ursinho",
  "Kit Spa Beb√™",
  "Bab√° Eletr√¥nica com IA",
  "Cadeira Musical de Alimenta√ß√£o",
  "Troninho com Feedback Sonoro",
  "Kit Penteado Fashion Baby",
  "Touca para Sonhos Doces",
  "Almofada que Conta Hist√≥rias",
  "Colchonete Infl√°vel M√°gico",
  "Canguru com Suspens√≥rio Revers√≠vel",
  "Macac√£o com GPS",
  "Fralda Noturna com Luz de LED",
  "Toalhas que Fazem C√≥cegas",
  "Copo de Treinamento com N√≠vel de Felicidade"
];
let presentes = [];
fetch('https://script.google.com/macros/s/AKfycbzYkqVKcTvZ5Me16JxObtRbffasEK2RJmLpBrv4EzE7yYDmXLd-6qTnzw2RZCYryLhj4g/exec')
  .then(r => r.json())
  .then(data => {
    presentes = data;
    renderizarPresentes();
  });
function emoji(nome) {
  const mapa = {
    cuequinha: 'ü©≤', toalha: 'üßª', camiseta: 'üëï', macac√£o: 'üß•', pato: 'ü¶Ü',
    babador: 'üçº', mamadeira: 'üçº', term√¥metro: 'üå°Ô∏è', sabonete: 'üßº', tapete: 'üß∏',
    livro: 'üìò', kit: 'üéÅ', travesseiro: 'üõèÔ∏è', copo: 'ü•§', brinquedo: 'ü™Ä',
    almofada: 'üõãÔ∏è', porta: 'üß∫', luva: 'üß§', escova: 'ü™•', canguru: 'üê®',
    cadeirinha: 'ü™ë', naninha: 'üß∏', roup√£o: 'üëò', bomba: 'üçº', ber√ßo: 'üõèÔ∏è',
    bab√°: 'üìπ', cadeira: 'ü™ë', troninho: 'üöΩ', organizador: 'üóÇÔ∏è', mochila: 'üéí',
    pote: 'ü•£', talheres: 'üç¥', len√ßol: 'üõå', colchonete: 'üõå', trocador: 'üîÑ',
    cortador: '‚úÇÔ∏è', dental: 'ü¶∑', touca: 'üé©', meias: 'üß¶'
  };
  const chave = Object.keys(mapa).find(k => nome.toLowerCase().includes(k));
  return chave ? mapa[chave] : 'üéÅ';
}
function renderizarPresentes() {
  presentes.sort((a, b) => parseFloat(a.valor) - parseFloat(b.valor));
  const gal = document.getElementById('presentes');
  gal.innerHTML = '';
  presentes.forEach((p, i) => {
    const esgotado = p.cotas === 0;
    const div = document.createElement('div');
    div.className = 'item';
    div.innerHTML = `
      <div class='emoji'>${emoji(nomesProdutos[p.id] || p.nome)}</div>
      <h3 style='color:${esgotado ? "gray" : "inherit"}'>${nomesProdutos[p.id] || p.nome}</h3>
      <p style='color:${esgotado ? "gray" : "black"};font-weight:bold'>Valor: R$ ${p.valor}</p>
      ${!esgotado ? `<p>Cotas dispon√≠veis: ${p.cotas}</p>` : ''}
      <button onclick='if (!${esgotado}) presentear(${i})' style='background:${esgotado ? "gray" : "#5F805F"};cursor:${esgotado ? "not-allowed" : "pointer"}'>${esgotado ? "ESGOTADO" : "PRESENTEAR"}</button>`;
    gal.appendChild(div);
  });
}
</script>
<div id="modalPagamento" class="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:1000;">
  <div class="modal-content" style="background:white; padding:30px; border-radius:10px; max-width:500px; width:90%; text-align:center; position:relative;">
    <button onclick="fecharModal()" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:20px; cursor:pointer">‚ùå</button>
    <div id="modalEmoji" style="font-size:64px;"></div>
    <h2 id="modalNome"></h2>
    <p style="font-size:1.2em;color:black;font-weight:bold">Valor: R$ <span id="modalValor"></span></p>
    <p style="font-size:1.1em;color:black">Chave Pix: <strong>065.755.339-57</strong> <button onclick="copiarPix(this)">Copiar</button></p>
    <p style="margin-top:10px;color:#4CAF50;font-weight:bold">Papai, mam√£e e Jo√£o agradecem de cora√ß√£o pelo presente! ‚ù§Ô∏è</p>
    <hr style="margin:20px 0">
    <h2>Mensagem para o Jo√£o</h2>
    <label>Seu nome:</label><br>
    <input type="text" id="nomeMsg" maxlength="50" style="width:90%;margin:5px"><br>
    <label>Deixe sua mensagem:</label><br>
    <textarea id="textoMsg" maxlength="500" oninput="atualizarContador()" style="width:90%;height:100px;margin:5px"></textarea><br>
    <div id="contadorMsg">500 caracteres restantes</div>
    <button onclick="enviarMensagem()">Enviar Mensagem</button>
  </div>
</div>

<script>
function abrirModalPagamento(p) {
  const nomeFinal = nomesProdutos[p.id] || p.nome;
document.getElementById('modalEmoji').textContent = emoji(nomeFinal);
  document.getElementById('modalNome').textContent = nomeFinal;
  document.getElementById('modalValor').textContent = p.valor;
  document.getElementById('modalPagamento').style.display = 'flex';
  document.getElementById('nomeMsg').value = '';
  document.getElementById('textoMsg').value = '';
  atualizarContador();
  produtoAtual = p;
}

function fecharModal() {
  document.getElementById('modalPagamento').style.display = 'none';
}

function copiarPix(btn) {
  navigator.clipboard.writeText('06575533957');
  btn.textContent = 'Copiado!';
  setTimeout(() => btn.textContent = 'Copiar', 2000);
}

function atualizarContador() {
  const txt = document.getElementById('textoMsg');
  const contador = document.getElementById('contadorMsg');
  const restante = 500 - txt.value.length;
  contador.textContent = `${restante} caracteres restantes`;
}

let produtoAtual = null;
function enviarMensagem() {
  const nome = document.getElementById('nomeMsg').value.trim();
  const texto = document.getElementById('textoMsg').value.trim();
  if (!nome || !texto || !produtoAtual) {
    alert('Preencha nome, mensagem e selecione um produto.');
    return;
  }
  fetch('https://script.google.com/macros/s/AKfycbzYkqVKcTvZ5Me16JxObtRbffasEK2RJmLpBrv4EzE7yYDmXLd-6qTnzw2RZCYryLhj4g/exec?tipo=mensagem', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ nome, produto: nomesProdutos[produtoAtual.id] || produtoAtual.nome, valor: produtoAtual.valor, texto })
  });
  if (produtoAtual.cotas > 0) {
    produtoAtual.cotas--;
    fetch('https://script.google.com/macros/s/AKfycbzYkqVKcTvZ5Me16JxObtRbffasEK2RJmLpBrv4EzE7yYDmXLd-6qTnzw2RZCYryLhj4g/exec?tipo=presente', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ nome: produtoAtual.nome, cotas: produtoAtual.cotas })
    });
  }
  alert('Mensagem enviada com sucesso!');
  fecharModal();
  renderizarPresentes();
}

function presentear(index) {
  const p = presentes[index];
  if (!p || p.cotas === 0) return;
  abrirModalPagamento(p);
}

document.addEventListener('keydown', function(event) {
  if (event.key === 'Escape') {
    fecharModal();
  }
});
</script>
